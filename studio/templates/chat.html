<!DOCTYPE html>
<html>
<head>
    <title>{{ agent | capitalize }} Chat</title>
    <link rel="stylesheet" href="/static/styles.css">
    <script>
        if (localStorage.getItem("theme") === "dark") {
            document.body.classList.add("dark");
        }
    </script>
</head>
<body class="with-bg">
    <button onclick="toggleTheme()" class="theme-toggle">üåì</button>
    <div class="sidebar">
        <a href="/">‚Üê Home</a>
        <h2>Chat Agents</h2>
        {% for id, model in models.items() %}
        <a href="/chat/{{ id }}">{{ model.label }}</a>
        {% endfor %}
    </div>
    <button class="sidebar-toggle" onclick="document.body.classList.toggle('collapsed')">‚ò∞</button>
    <div class="chat-container">
        {% if response %}
        <div class="message-card user">
            <strong>You:</strong><br>{{ user_input }}
        </div>
        <div class="message-card ai">
            <strong>AI:</strong><br>{{ response }}
            <button class="floating-word-btn" title="Generate Doc">W</button>
        </div>
        {% else %}
        <div class="empty-placeholder"></div>
        {% endif %}
    </div>

    <form method="post" class="input-form">
        <textarea name="user_input" id="user_input" rows="2" placeholder="Send a message..." required></textarea>
        <button type="submit" onclick="submitChat()">‚û§</button>
    </form>
    <script>
        function toggleTheme() {
            document.body.classList.toggle("dark");
            localStorage.setItem("theme", document.body.classList.contains("dark") ? "dark" : "light");
        }
        window.onload = () => {
            if (localStorage.getItem("theme") === "dark") {
                document.body.classList.add("dark");
            }
            const textarea = document.getElementById("user_input");
            if (textarea) {
                textarea.addEventListener("keydown", function (event) {
                    if (event.key === "Enter" && !event.shiftKey) {
                        event.preventDefault();
                        this.form.submit(); // submits the form
                        }
                    });
                }
            };
        </script>
    </body>
</html>